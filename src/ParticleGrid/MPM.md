# MPM


## **原理**：

物质点法 (material point method, MPM)采用拉格朗日和欧拉双重描述，将物体离散为一组在空间网格中运动的质点。
- 质点携带了所有的物质信息，如质量、速度、应变和应力等，可很方便地跟踪材料的界面和引入与变形历史相关的材料模型。
- 质点在空间网格中运动，运动方程在空间网格上求解，避免了网格畸变问题，适合于分析特大变形及流动问题。

## 核心思想

拉格朗日视角 (粒子)：物质点携带密度、速度、应力等信息，随物质变形运动。  
欧拉视角 (背景网格)：划分计算域，用于计算空间导数和物理量更新。  
粒子-网格-粒子 (P-G-P)：信息通过物质点映射到网格节点，在网格上计算更新，再插值回物质点，完成一个时间步。   

## 主要特点与优势
融合拉格朗日与欧拉：兼具拉格朗日法的精确追踪物质界面能力和欧拉法的网格独立性，避免了有限元网格缠绕畸变问题。  
处理大变形：能有效模拟材料的超大变形、破碎、断裂等非线性问题。  
自动处理多体接触：物质点在网格内运动，自动处理多介质界面，无需复杂的碰撞检测。  
适用范围广：适用于高速碰撞、爆炸冲击、岩土动力学、流体与固体相互作用等复杂问题。    

但 MPM 在精度上存在劣势。   

## 基本步骤（一个时间步）  

![](../assets/10-2-6.png) 

### 粒子到网格 (P2G)

将物质点信息（如质量、动量）通过插值函数映射到背景网格节点。  
### 网格计算

在背景网格上，根据控制方程（如动量守恒）计算节点力、加速度等。  

### 网格到粒子 (G2P)

将网格上的计算结果（如速度、应力）通过插值函数传回物质点。  
（可选）丢弃网格：根据需要重新划分或更新背景网格。   
### 更新粒子

更新物质点的位置、速度和应力状态。  

## **优点**

避免网格畸变，适合大变形问题（如雪、泥沙、断裂模拟）。

## **变种**
  - **广义插值物质点法（GIMP）**：改进插值函数，减少数值噪声。
  - **CPDI（Convected Particle Domain Interpolation）**：更精确描述粒子变形。


## 应用场景

1. 可以处理不同材质(流、固等)及它们之间的耦合关系    
2. 可以处理碰撞、破碎等效果    
3. 擅长摸拟大形变     

## P2G     
 
1. 粒子的质量、动量、速度等属性，过程同PIC      
2. 粒子应力属性 ⟶ 网格力属性     
流体/固体受力 ⟶ 变形梯度 F ⟶ 柯西应力张量 σ ⟶ 应力张量散度 ⟶ 粒子时网格的力     
力来自应力的空间变化(梯度)，而不是应力本身的空间插值。    
 
## 网格更新    

![](../assets/10-2-61.png) 

只更新网格速度    
 
### G2P    
 
1. 网格速度插值出粒子速度    
2. 更新粒子位置    
3. 重新计算粒子的变形梯度/应力     
变形梯度F的更新 \\(∇N_I(x_P)\\)    

> &#x1F50E; Deborah Sulsky, Shi-Jian Zhou, and Howard L Schreyer.
Application of a particle-in-cell method to solid mechanics.


---------------------------------------
> 本文出自CaterpillarStudyGroup，转载请注明出处。
>
> https://caterpillarstudygroup.github.io/GAMES103_mdbook/

